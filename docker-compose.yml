
services:

  database:
    image: neo4j:5.23.0
    container_name: neo4j
    ports:
      - "7474:7474"
      - "7687:7687"
    environment:
      - NEO4J_AUTH=neo4j/StrongPsPsP5
      - SSL_CERT_DIR=/etc/ssl/certs

  test:
    build:
      context: .
      dockerfile: dockerfile
    depends_on:
      - database
    links:
      - database
    container_name: ragger
    environment:
      - SSL_CERT_DIR=/etc/ssl/certs
    command: > 
      bash -c "python3 -m pytest || exit 1" 
      && docker-compose down
